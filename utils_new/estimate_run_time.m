% Author:        LÃ©o Martire.
% Mail:          leo.martire@outlook.com
% Description:   Estimate new run time based on previous runs' saved data.
% Last modified: See file metadata.
% Usage:         N/A.
% Notes:         N/A.

clear all
close all
clc
format longG;

[data, t]=load(); % Load data (see function below).

% Set new run key data here.
neltot    = 2892000;
neldg     = 2832000;
nstepsnap = 300;
nsteptot  = 300000;
nproc     = 32*16;

point=[neldg/neltot,nstepsnap/nsteptot,neltot/nproc]; % Format point as data format. Currently [% elements as DG, % timesteps as snapshots, elements per proc].

disp(strcat("Current point:            [ ", sprintf("%.3e ", point), "]."));
idp=dsearchn(data,point);
disp(strcat("Closest data point found: [ ", sprintf("%.3e ", data(idp,:)), "]."));
time=t(idp);

disp(" ");

disp(strcat("Expected time per element, per iteration: ",sprintf("%.3e", time), " s."));
disp(strcat("Expected run time:                        ",sprintf("%.3e", time*neltot*nsteptot/3600), " h (CPU)."));
disp(strcat("                                          ",sprintf("%.3e", time*neltot*nsteptot/3600/nproc), " h (real)."));

function [d, t]=load()
  d=[
  1.0000000000000000E+000,2.5000000000000000E-002,625;
  1.0000000000000000E+000,2.5000000000000000E-002,156;
  1.0000000000000000E+000,2.5000000000000000E-002,10;
  1.0000000000000000E+000,1.2500000000000000E-002,2500;
  1.0000000000000000E+000,1.2500000000000000E-002,625;
  1.0000000000000000E+000,1.2500000000000000E-002,39;
  1.0000000000000000E+000,6.2500000000000000E-003,10000;
  1.0000000000000000E+000,6.2500000000000000E-003,2500;
  1.0000000000000000E+000,6.2500000000000000E-003,156;
  1.0000000000000000E+000,6.2500000000000000E-003,78;
  1.0000000000000000E+000,6.2500000000000000E-003,39;
  1.0000000000000000E+000,3.1250000000000000E-003,625;
  1.0000000000000000E+000,3.1250000000000000E-003,313;
  1.0000000000000000E+000,3.1250000000000000E-003,156;
  1.0000000000000000E+000,1.5625000000000000E-003,2500;
  1.0000000000000000E+000,1.5625000000000000E-003,1250;
  1.0000000000000000E+000,1.5625000000000000E-003,625;
  1.0000000000000000E+000,0.0000000000000000E+000,10000;
  1.0000000000000000E+000,0.0000000000000000E+000,5000;
  1.0000000000000000E+000,0.0000000000000000E+000,2500;
  9.0773809523809500E-001,1.6666666666666700E-003,7875;
  9.0773809523809500E-001,1.6666666666666700E-003,7875;
  6.6079295154185000E-001,1.6666666666666700E-002,887;
  6.6079295154185000E-001,1.6666666666666700E-002,887;
  9.7925311203319500E-001,7.4074074074074100E-003,5648;
  1.0000000000000000E+000,6.8027210884353700E-003,816
  ];
  t=[
  6.5600000000000000E-005;
  7.6800000000000000E-005;
  5.6320000000000000E-004;
  9.2000000000000000E-005;
  1.0280000000000000E-004;
  1.7920000000000000E-004;
  1.0358750000000000E-004;
  1.1630000000000000E-004;
  1.2560000000000000E-004;
  2.0160000000000000E-004;
  3.9360000000000000E-004;
  1.3610000000000000E-004;
  1.6560000000000000E-004;
  2.3040000000000000E-004;
  1.4953750000000000E-004;
  1.7362500000000000E-004;
  2.3640000000000000E-004;
  1.3353125000000000E-004;
  1.2979375000000000E-004;
  1.1783750000000000E-004;
  1.3217142857142900E-004;
  1.3019470899470900E-004;
  1.0976798825257000E-004;
  1.1202349486049900E-004;
  1.5238563598176300E-004;
  2.0939463074663300E-004
  ];
end